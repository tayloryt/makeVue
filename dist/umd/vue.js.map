{"version":3,"file":"vue.js","sources":["../../src/utils/index.js","../../src/observe/observeArray.js","../../src/observe/index.js","../../src/state.js","../../src/complier/index.js","../../src/init.js","../../src/index.js"],"sourcesContent":["//判断是否数组\nexport function isObject(data) {\n    return typeof data === 'object' && data !==null\n}\nexport function def(data, key, value) {\n    Object.defineProperty(data, key, {\n        enumerable: false,\n        configurable: false,\n        value\n    })\n}","let oldArrayPrototype = Array.prototype;\nexport let arrayMethods = Object.create(oldArrayPrototype)\nconst METHODS = [\n    'push',\n    'splice',\n    'unshift',\n    'pop',\n    'shift',\n    'reverse',\n    'sort'\n]\nMETHODS.forEach(method => {\n    arrayMethods[method] = function (...args) {\n        oldArrayPrototype[method].call(this, ...args);\n        let insertData;\n        let ob = this.__ob__\n        switch (method) {\n            case 'push':\n            case 'unshift':\n                insertData = args\n                break;\n            case 'splice':\n                insertData = args.slice(2)\n                break;\n        }\n        if(insertData) ob.observeArray(insertData)\n    }\n})","/**\n * 观测数据\n * @param {data} \n */\nimport { isObject, def } from '../utils/index'\nimport {arrayMethods} from './observeArray'\nclass Observe{\n    constructor(value) {\n        console.log(value)\n        if (Array.isArray(value)) {\n            def(value, '__ob__', this)\n            value.__proto__ = arrayMethods\n            this.observeArray(value)\n        } else {\n            this.walk(value)\n        }\n       \n    }\n    observeArray(value) {\n        for (let i = 0; i < value.length; i++){\n            observe(value[i])\n        }\n    }\n    walk(value) {\n        Object.keys(value).forEach(key => {\n            defineReactive(value, key, value[key])\n        })\n    }\n}\nfunction defineReactive(data, key, value) {\n    observe(value)\n    Object.defineProperty(data, key, {\n        get() {\n            return value\n        },\n        set(newValue) {\n            if (newValue === value) return;\n            observe(newValue)\n            value = newValue\n        }\n    })\n}\nexport function observe(data) {\n    if (!isObject(data)) return\n    new Observe(data)\n}","import { observe } from './observe/index'\nexport function initState(vm) {\n    if (vm.$options.props) {\n        initProps(vm)\n    }\n    if (vm.$options.methods) {\n        initMethods(vm)\n    }\n    if (vm.$options.data) {\n        initData(vm)\n    }\n    if (vm.$options.computed) {\n        initComputed(vm)\n    }\n    if (vm.$options.watch) {\n        initWatch(vm)\n    }\n}\nfunction initProps(vm) {\n\n}\nfunction initMethods(vm) {\n\n}\nfunction initData(vm) {\n    let data = vm.$options.data;\n    data = vm._data = typeof data === 'function' ? data.call(vm) : data\n    observe(data)\n}\nfunction initComputed(vm) { }\nfunction initWatch(vm) { }\n","const ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`;\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`;\nconst startTagOpen = new RegExp(`^<${qnameCapture}`);\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`);\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/;\nconst startTagClose = /^\\s*(\\/?)>/;\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g\nfunction end(tagName) {\n    console.log(\"结束标签\",tagName)\n}\nfunction chars(text) {\n    console.log(\"文本内容\",text)\n}\nfunction start(tagName,attrs) {\n    console.log(tagName,attrs)\n}\nfunction parseHtml(html) {\n    while (html) {\n        let textEnd = html.indexOf('<')\n        if (textEnd === 0) {\n            let startTagMatch = parseStartTag()\n            if (startTagMatch) {\n                start(startTagMatch.tagName,startTagMatch.attrs)\n            continue\n            }\n            let endTagMatch = html.match(endTag)\n            if (endTagMatch) {\n                advance(endTagMatch[0].length)\n                end(endTagMatch[1])\n            }\n        }\n        let text;\n        if (textEnd >= 0) {\n            text = html.substring(0, textEnd)\n        }\n        if (text) {\n            advance(text.length) \n            chars(text)\n        }\n    }\n    function advance(n) {\n        html = html.substring(n)\n    }\n    function parseStartTag() {\n        let start = html.match(startTagOpen);\n        if (start) {\n            const match = {\n                tagName: start[1],\n                attrs:[]\n            }\n            advance(start[0].length)\n            let end, attr;\n            while (!(end = html.match(startTagClose)) && (attr = html.match(attribute))) {\n                match.attrs.push({\n                    name: attr[1],\n                    value:attr[3] || attr[4] || attr[5]\n                })\n                advance(attr[0].length)\n            }\n            if (end) {\n                advance(end[0].length)\n            }\n            return match\n        }\n    }\n}\n\nexport function compilationToRender(template) {\n    let root = parseHtml(template)\n    return function render() {\n        \n    }\n}","import { initState } from './state'\nimport {compilationToRender} from './complier/index'\nexport function initMixin(Vue) {\n    Vue.prototype._init = function (options) {\n        const vm = this\n        vm.$options = options\n        initState(vm)\n    }\n    Vue.prototype.$mount = function (el) {\n        const vm = this;\n        const options = vm.$options;\n        el = document.querySelector(el)\n        if (!options.render) {\n            let template = options.template\n            if (!template && el) {\n                template = el.outerHTML;\n                compilationToRender(template)\n            }\n        }\n    }\n}","/**\n * vue 核心代码\n */\nimport {initMixin} from './init'\nclass Vue{\n    constructor(options) {\n        this._init(options)\n        if (options.el) {\n            this.$mount(options.el)\n        }\n    }\n}\ninitMixin(Vue)\n\nexport default Vue"],"names":["isObject","data","def","key","value","Object","defineProperty","enumerable","configurable","oldArrayPrototype","Array","prototype","arrayMethods","create","METHODS","forEach","method","args","call","insertData","ob","__ob__","slice","observeArray","Observe","console","log","isArray","__proto__","walk","i","length","observe","keys","defineReactive","get","set","newValue","initState","vm","$options","props","methods","initData","computed","watch","_data","ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","end","tagName","chars","text","start","attrs","parseHtml","html","textEnd","indexOf","startTagMatch","parseStartTag","endTagMatch","match","advance","substring","n","attr","push","name","compilationToRender","template","root","render","initMixin","Vue","_init","options","$mount","el","document","querySelector","outerHTML"],"mappings":"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"}